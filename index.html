<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ESP8266 Relay Control Dashboard</title>
  <link rel="manifest" href="manifest.json" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" />
  <meta name="theme-color" content="#0d6efd" />
</head>

<body class="bg-light text-dark">

  <div class="container py-4">
    <h1 class="text-center mb-4">ESP8266 Relay Control Dashboard</h1>

    <!-- Login Form -->
    <div class="d-flex justify-content-center mb-4">
      <input type="email" id="email" class="form-control me-2" placeholder="Enter Email" style="max-width: 250px;">
      <input type="password" id="password" class="form-control me-2" placeholder="Enter Password" style="max-width: 250px;">
      <button onclick="login()" class="btn btn-primary">Login</button>
    </div>

    <!-- Relay Control Section -->
    <div id="relayContainer" style="display:none">
      <div class="row row-cols-1 row-cols-md-2 g-4">

        <!-- Relay 1 -->
        <div class="col">
          <div class="card shadow-sm">
            <div class="card-body text-center">
              <h5 class="card-title">Relay 1</h5>
              <p id="status1" class="fw-bold text-secondary">Status: Loading...</p>
              <button class="btn btn-success" onclick="toggleRelay(1)">Toggle</button>
            </div>
          </div>
        </div>

        <!-- Relay 2 -->
        <div class="col">
          <div class="card shadow-sm">
            <div class="card-body text-center">
              <h5 class="card-title">Relay 2</h5>
              <p id="status2" class="fw-bold text-secondary">Status: Loading...</p>
              <button class="btn btn-success" onclick="toggleRelay(2)">Toggle</button>
            </div>
          </div>
        </div>

        <!-- Relay 3 -->
        <div class="col">
          <div class="card shadow-sm">
            <div class="card-body text-center">
              <h5 class="card-title">Relay 3</h5>
              <p id="status3" class="fw-bold text-secondary">Status: Loading...</p>
              <button class="btn btn-success" onclick="toggleRelay(3)">Toggle</button>
            </div>
          </div>
        </div>

        <!-- Relay 4 -->
        <div class="col">
          <div class="card shadow-sm">
            <div class="card-body text-center">
              <h5 class="card-title">Relay 4</h5>
              <p id="status4" class="fw-bold text-secondary">Status: Loading...</p>
              <button class="btn btn-success" onclick="toggleRelay(4)">Toggle</button>
            </div>
          </div>
        </div>
      </div>

      <!-- Control Buttons -->
      <div class="d-flex justify-content-center mt-4 gap-3">
        <button class="btn btn-danger" onclick="turnAllOff()">All OFF</button>
        <button class="btn btn-secondary" onclick="logout()">Logout</button>
      </div>
    </div>

    <p class="text-center mt-5 small">Created for ESP8266 Firebase Relay Control</p>
  </div>

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>

  <script>
    
    //  Firebase configuration
const firebaseConfig = {
  apiKey: "AIzaSyBqKRX7oFQmHo7vcFsQ10fXsNLR7YkGlcE",
  authDomain: "esp8266-relay-c1de8.firebaseapp.com",
  databaseURL: "https://esp8266-relay-c1de8-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "esp8266-relay-c1de8",
  storageBucket: "esp8266-relay-c1de8.firebasestorage.app",
  messagingSenderId: "511505821809",
  appId: "1:511505821809:web:7e7b07c40d4f642ee9ebd0"
};

    firebase.initializeApp(firebaseConfig);

    const auth = firebase.auth();
    const database = firebase.database();

    // ðŸ”¹ Login
    function login() {
      const email = document.getElementById("electricaluzair").value;
      const password = document.getElementById("electrical123").value;

      auth.signInWithEmailAndPassword(email, password)
        .then(() => {
          document.getElementById("relayContainer").style.display = "block";
          listenToRelayChanges();
        })
        .catch(error => alert("Login Failed: " + error.message));
    }

    // ðŸ”¹ Logout
    function logout() {
      auth.signOut().then(() => {
        document.getElementById("relayContainer").style.display = "none";
        alert("Logged out successfully!");
      });
    }

    // ðŸ”¹ Listen to Relay Updates in Real-time
    function listenToRelayChanges() {
      for (let i = 1; i <= 4; i++) {
        const statusEl = document.getElementById(`status${i}`);
        const relayRef = database.ref(`/relay${i}`);

        relayRef.on("value", snapshot => {
          const state = snapshot.val();
          if (state === true) {
            statusEl.textContent = "Status: ON";
            statusEl.classList.remove("text-secondary");
            statusEl.classList.add("text-success");
          } else {
            statusEl.textContent = "Status: OFF";
            statusEl.classList.remove("text-success");
            statusEl.classList.add("text-secondary");
          }
        });
      }
    }

    // ðŸ”¹ Toggle Relay
    function toggleRelay(relayNum) {
      const relayRef = database.ref(`/relay${relayNum}`);
      relayRef.once("value").the
